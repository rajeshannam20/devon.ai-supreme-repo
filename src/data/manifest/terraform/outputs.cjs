
// Output definitions for Terraform

export const outputsConfigYaml = `# --- Outputs Configuration ---

output "eks_cluster_endpoint" {
  description = "Endpoint for EKS control plane"
  value       = module.eks.cluster_endpoint
}

output "eks_cluster_security_group_id" {
  description = "Security group ids attached to the cluster control plane"
  value       = module.eks.cluster_security_group_id
}

output "eks_kubectl_config" {
  description = "kubectl config as generated by the module"
  value = yamlencode({
    apiVersion = "v1"
    clusters = [{
      cluster = {
        "certificate-authority-data" = module.eks.cluster_certificate_authority_data
        server                     = module.eks.cluster_endpoint
      }
      name = module.eks.cluster_name
    }]
    contexts = [{
      context = {
        cluster = module.eks.cluster_name
        user    = module.eks.cluster_name
      }
      name = module.eks.cluster_name
    }]
    "current-context" = module.eks.cluster_name
    kind              = "Config"
    users = [{
      name = module.eks.cluster_name
      user = {
        exec = {
          apiVersion = "client.authentication.k8s.io/v1alpha1"
          command    = "aws"
          args       = ["eks", "get-token", "--cluster-name", module.eks.cluster_name]
        }
      }
    }]
  })
  sensitive = true
}

output "rds_instance_address" {
  description = "The address of the RDS instance"
  value       = module.rds.db_instance_address
  sensitive   = true
}

output "connection_instructions" {
  description = "Instructions to connect to the cluster"
  value       = "Run: aws eks update-kubeconfig --name devonn-eks-\${var.environment} --region \${var.aws_region}"
}

# New Outputs for rds_endpoint and eks_cluster_name
output "rds_endpoint" {
  description = "Endpoint for the RDS instance"
  value       = module.rds.db_instance_address
  sensitive   = false
}

output "eks_cluster_name" {
  description = "The name of the EKS cluster"
  value       = module.eks.cluster_name
  sensitive   = false
}

output "rds_endpoint_id" {
  value = module.rds.db_instance_arn
  description = "The ID of the RDS instance"
}

# Example tfvars file structure (create these in environments/prod.tfvars, environments/staging.tfvars, etc)
# aws_region = "us-west-2"
# environment = "prod"
# vpc_cidr = "10.0.0.0/16"
# availability_zones = ["us-west-2a", "us-west-2b"]
# private_subnet_cidrs = ["10.0.1.0/24", "10.0.2.0/24"]
# public_subnet_cidrs = ["10.0.101.0/24", "10.0.102.0/24"]
# node_desired_capacity = 2
# node_max_capacity = 4
# node_min_capacity = 1
# node_instance_types = ["t3.medium"]
# node_disk_size = 50
# db_instance_class = "db.t3.micro"
# db_allocated_storage = 20
# db_max_allocated_storage = 50
# db_password = "CHANGE_ME_IN_PROD"`;
